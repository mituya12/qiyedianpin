# API测试快速开始指南

## 📋 前置条件

1. ✅ 数据库已初始化
2. ✅ 测试数据已导入
3. ✅ 服务器正在运行

## 🚀 快速开始

### 步骤1: 安装依赖

```bash
npm install
```

### 步骤2: 启动服务器

```bash
# 开发模式启动
npm run dev
```

### 步骤3: 执行测试

打开新的终端窗口,执行:

```bash
npm test
```

## 📊 测试输出示例

```
━━━ 🚀 开始执行API接口测试 ━━━

ℹ 测试环境: http://localhost:3000
ℹ 开始时间: 2025-11-27 15:00:00

━━━ 📱 C端API测试 ━━━

━━━ C端用户模块测试 ━━━

▸ 1. 测试微信登录
✓ 微信登录成功
  Token: eyJhbGciOiJIUzI1NiI...
  用户信息: {
  "id": 1,
  "name": "张三",
  ...
}

▸ 2. 测试获取用户信息
✓ 获取用户信息成功

▸ 3. 测试更新用户信息
✓ 更新用户信息成功

✓ 用户模块测试完成

...

━━━ 📊 测试结果统计 ━━━

ℹ 总测试数: 11
✓ 通过: 11
ℹ 成功率: 100.00%
ℹ 结束时间: 2025-11-27 15:01:00
```

## 🎨 日志颜色说明

- ✓ **绿色**: 测试通过
- ✗ **红色**: 测试失败
- ⚠ **黄色**: 警告信息
- ℹ **蓝色**: 提示信息
- ▸ **紫色**: 子测试项

## ⚙️ 配置修改

如需修改测试配置,编辑 `tests/config.js`:

```javascript
module.exports = {
  baseURL: 'http://localhost:3000',  // 修改API地址
  timeout: 10000,                     // 修改超时时间
  testAdmin: {
    username: 'admin',                // 修改测试管理员
    password: 'admin123'
  }
};
```

## 📝 测试覆盖

### C端API (5个模块)
1. ✅ 用户模块 - 3个接口
2. ✅ 企业模块 - 4个接口
3. ✅ 评价模块 - 6个接口
4. ✅ 回复模块 - 2个接口
5. ✅ 举报模块 - 1个接口

### B端API (6个模块)
1. ✅ 管理员认证 - 2个接口
2. ✅ 企业管理 - 5个接口
3. ✅ 评价管理 - 4个接口
4. ✅ 回复管理 - 4个接口
5. ✅ 用户管理 - 3个接口
6. ✅ 举报管理 - 3个接口

**总计**: 37个API接口测试

## ❓ 常见问题

### Q: 测试失败怎么办?
A: 检查服务器是否正常运行,数据库是否已初始化

### Q: 如何只测试某个模块?
A: 直接运行对应的测试文件,例如:
```bash
node tests/c-api/user.test.js
```

### Q: 测试数据会影响数据库吗?
A: 是的,测试会创建真实数据,建议在开发环境执行

### Q: 如何清理测试数据?
A: 重新初始化数据库:
```bash
npm run init-db
node scripts/data/index.js
```
